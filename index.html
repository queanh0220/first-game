<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title></title>
	<style type="text/css">
		canvas { background: #eee; display: block; margin: 0 auto; }
	</style>
</head>
<body>
	<canvas id="myCanvas" width = "500" height = "350"></canvas>
	<script type="text/javascript">
		var canvas = document.getElementById("myCanvas");
		var ctx = canvas.getContext("2d");
		const colors = [
		  "#f90707",
		  "#ffeb3b",
		  "#59ff3b",
		  "#3bfff6",
		  "#1a20e5",
		  "#f919e8",
		  "#744967",
		  "#7cffd5",
		  "#9fa3a2",
		];
		var lives = 2;
		var score = 0;
		var idcolor = 0;
		var x = canvas.width/2, y = canvas.height-30;
		var ballRadius = 12;
		var dx = 5, dy = -5;

		var paddleHeight = 12, paddleWidth = 100;
		var paddleX = (canvas.width - paddleWidth) / 2;
		var rightPressed = false;
		var leftPressed = false;

		var brickRowCount = 3;
		var brickColumnCount = 5;
		var brickWidth = 75;
		var brickHeight = 20;
		var brickPadding = 10;
		var brickOffsetTop = 30;
		var brickOffsetLeft = 30;

		var bricks = [];
		for(var c=0; c<brickColumnCount; c++) {
		    bricks[c] = [];
		    for(var r=0; r<brickRowCount; r++) {
		        bricks[c][r] = { x: 0, y: 0, status: true };
		    }
		}

		document.addEventListener("keydown", keyDownHandler, false);
		document.addEventListener("keyup", keyUpHandler, false);
		document.addEventListener("mousemove", mouseMoveHandler, false);

		function drawLives() {
		    ctx.font = "16px Arial";
		    ctx.fillStyle = "#0095DD";
		    ctx.fillText("Lives: "+lives, canvas.width-65, 20);
		}

		function drawScore() {
			ctx.font = "16px Arial";
			ctx.fillStyle = "#0095DD";
			ctx.fillText("Score: "+score, 8, 20);
		}

		function drawBall(){
			ctx.beginPath();
			ctx.arc(x,y,ballRadius,0,Math.PI*2,false);
			ctx.fillStyle = colors[idcolor];
			ctx.fill();
			ctx.closePath();
		}

		function drawPaddle(){
			ctx.beginPath();
			ctx.rect(paddleX,canvas.height - paddleHeight, paddleWidth, paddleHeight);
			ctx.fillStyle = "blue";
			ctx.fill();
			ctx.closePath();
		}

		function drawBrick(){
			var brickX = (c*(brickWidth+brickPadding))+brickOffsetLeft;
			var brickY = (r*(brickHeight+brickPadding))+brickOffsetTop;
			 for(var c=0; c<brickColumnCount; c++) {
		        for(var r=0; r<brickRowCount; r++) {
		        	if(bricks[c][r].status) {
		        		var brickX = (c*(brickWidth+brickPadding))+brickOffsetLeft;
			            var brickY = (r*(brickHeight+brickPadding))+brickOffsetTop;
			            bricks[c][r].x = brickX;
			            bricks[c][r].y = brickY;
			            ctx.beginPath();
			            ctx.rect(brickX, brickY, brickWidth, brickHeight);
			            ctx.fillStyle = "blue";
			            ctx.fill();
			            ctx.closePath();
		        	}
		        }
		    }
		}

		function draw(){
			ctx.clearRect(0, 0, canvas.width,canvas.height);
			drawBall();
			drawPaddle();
			drawBrick();
			drawScore();
			drawLives();
			checkCollision();
			x += dx;
			y += dy;
			requestAnimationFrame(draw);
		}

		function checkCollision(){
			if(x + dx < ballRadius || x + dx > canvas.width - ballRadius){
				dx = -dx;
				idcolor++;
			} 
			if(y + dy < ballRadius){
				dy = -dy;
				idcolor++;
			} 
			if(y + dy > canvas.height - ballRadius) {
				if(x >= paddleX && x <= paddleX+paddleWidth) {
					dy = -dy;
					idcolor++;
				}
				else {
					lives--;
						if(!lives) {
						    alert("GAME OVER\nYOUR SCORE: "+score);
							document.location.read();
							//clearInterval(interval);
						}
						else {
						    x = canvas.width/2;
						    y = canvas.height-30;
						    dx = 5;
						    dy = -5;
						    paddleX = (canvas.width-paddleWidth)/2;
						}
				}
			}
			
			if(rightPressed) {
		        paddleX += 10;
		        if (paddleX + paddleWidth > canvas.width){
		            paddleX = canvas.width - paddleWidth;
		        }
		    }
		    else if(leftPressed) {
		        paddleX -= 10;
		        if (paddleX < 0){
		            paddleX = 0;
		        }
		    }

		    for(var c=0; c<brickColumnCount; c++) {
		        for(var r=0; r<brickRowCount; r++) {
		            var b = bricks[c][r];
		            if(b.status == 1) {
		                if(x > b.x && x < b.x+brickWidth && y > b.y && y < b.y+brickHeight) {
		                    dy = -dy;
		                    idcolor++;
		                    b.status = 0;
		                    score+=100;
		                    if(score/100 == brickRowCount*brickColumnCount) {
		                        alert("YOU WIN!\nYOUR SCORE: "+score);
		                        document.location.reload();
		                       // clearInterval(interval);
                    		}
		                }
		            }
		        }
		    }

		    if(idcolor > colors.length-1)idcolor = 0;
		}


		function keyDownHandler(e) {
			if(e.key == "Right" || e.key == "ArrowRight") {
				rightPressed = true;
			}
			else if(e.key == "Left" || e.key == "ArrowLeft") {
				leftPressed = true;
			}
		}

		function keyUpHandler(e) {
		    if(e.key == "Right" || e.key == "ArrowRight") {
		        rightPressed = false;
		    }
		    else if(e.key == "Left" || e.key == "ArrowLeft") {
		        leftPressed = false;
		    }
		}

		function mouseMoveHandler(e) {
		    var relativeX = e.clientX - canvas.offsetLeft;
		    if(relativeX > 0 && relativeX < canvas.width) {
		        paddleX = relativeX - paddleWidth/2;
		    }
		}
	draw();
	//	var interval = setInterval(draw,10);
	</script>
</body>
</html>